---
import Layout from "../layouts/Layout.astro";
import Header from "../components/header.astro";
import Card from "../components/card.astro";
import LinkButton from "../components/link-button.astro";
import { client } from "../sanity-client.ts";

const problems = await client.fetch(`*[_type == 'problem'].problem`);

// This initial problem is only for SEO purposes
const problem = problems[Math.floor(Math.random() * problems.length)];

const painPoints = [
  // TODO: Fetch these from Sanity.
  "Too complex, cloud is a maze.",
  "Too many tools, config chaos.",
  "Costs run wild, surprise bills.",
  "Security is tricky, who has access?",
  "No visibility, debugging sucks.",
];
---

<Layout
  schema={[
    {
      "@context": "https://schema.org",
      "@type": "WebSite",
      name: "Sokkel",
      alternateName: ["Sokkel", "Sokky", "sokkel.io"],
      url: "https://sokkel.io/",
    },
    {
      "@context": "https://schema.org",
      "@type": "Organization",
      name: "Sokkel",
      url: "https://sokkel.io/",
      logo: "https://sokkel.io/assets/logo.svg",
      sameAs: ["https://www.linkedin.com/company/sokkel"],
      image: "https://sokkel.io/assets/team.jpg",
      description:
        "Sokkel is the foundation and building blocks for managing your applications, smooooothly.",
      telephone: "+4795308087",
      email: "hello@sokkel.io",
      address: {
        "@type": "PostalAddress",
        streetAddress: "Arbins gate 11",
        addressLocality: "Oslo",
        addressCountry: "NO",
        addressRegion: "Oslo",
        postalCode: "0253",
      },
      vatID: "NO935108500",
      iso6523Code: "0192:935108500",
    },
  ]}
>
  <div class="container">
    <main>
      <Header link={{ text: "About us", href: "/about-us" }} />
      <section id="hero">
        <img src="/assets/logo.svg" alt="Sokkel" class="logo" />
        <h1>
          The AI-powered <span aria-hidden="true">âœ¨</span> platform for managing
          all your applications. <span class="smoooothly">Smoooothly.</span>
        </h1>

        <!--TODO: Don't let the button take up the full width-->
        <LinkButton href="https://tally.so/r/wb6R62">Join waitlist</LinkButton>
        <p class="problem">Because: {problem}</p>
      </section>

      <img
        class="illustration lambo-tape"
        src="/assets/lambo-tape.gif"
        alt="Burning Lamborghini with duct tape"
      />

      <h2>
        We are on a mission to make DevOps something you <i>don't</i> have to worry
        about.
      </h2>

        <div>
          <h3>DevOps today? Kinda painful.</h3>
          <ol>
            {painPoints.map((point) => <li>{point}</li>)}
          </ol>
        </div>

      <section id="cards">
        <h2>That's why Sokkel is making it smooooth.</h2>
        <Card
          emoji="ðŸš€"
          title="AI-powered Blueprints â€“ Set up and manage your applications effortlessly."
        >
          <p>
            Answer a few questions, and get a ready-to-go setupâ€”whether youâ€™re
            starting fresh or migrating.
          </p>
        </Card>
        <Card
          emoji="ðŸ“Š"
          title="Real-time insights â€“  See everything, zoom into anything."
        >
          <p>
            Get a clear overview of how your setup connects, with the ability to
            drill down into performance, costs, and issues.
          </p>
        </Card>
        <Card
          emoji="ðŸ¤–"
          title="AI Agent Stacky optimizations â€“ Automate, optimize, relax."
        >
          <p>
            Stacky fine-tunes your setup, reduces costs, and keeps things
            running smoothlyâ€”hands-free.
          </p>
        </Card>
        <Card
          emoji="ðŸŒ"
          title="Powered by GCP â€“ built for maximum flexibility."
        >
          <p>
            Fully optimized for Google Cloud, giving you the freedom to scale,
            adapt, and grow without limitations.
          </p>
        </Card>
        <Card
          emoji="ðŸ› "
          title="Built for SMBs â€“ Less overhead, more time for building."
        >
          <p>
            No DevOps team needed. Sokkel simplifies everything so you can focus
            on growing your software.
          </p>
        </Card>
      </section>
    </main>
  </div>
</Layout>

<style>
  main {
    background: #ffffff;
    display: flex;
    flex-direction: column;

    margin-inline: auto;
    padding: 1.5rem;

    font-size: 1.5rem;
    line-height: 2rem;
    gap: 6rem;
  }

  @media (min-width: 450px) {
    main {
      margin-block: 2rem;
      border-radius: 24px;
      max-width: 393px;
    }
  }

  .illustration {
    display: block;
    align-self: center;
    width: 100%;
    max-width: 445px;
    margin-block: 1rem;
  }

  section#hero {
    display: flex;
    flex-direction: column;
    gap: 2rem;

    h1 {
      font-size: 2.5rem;
      font-weight: 900;
      line-height: 2.9rem;
      margin-block: 0;
      text-wrap: pretty;

      .smoooothly {
        background: linear-gradient(
          270deg,
          #ccccff 31.45%,
          #9999ff 40.36%,
          #6666ff 48.59%,
          #3333ff 57.5%,
          #0000ff 65.72%,
          #0000cc 74.64%,
          #000099 83.55%,
          #000066 91.77%,
          #000033 100%
        );
        background-clip: text;
        -webkit-text-fill-color: transparent;
      }
    }

    .logo {
      max-width: 212px;
      // Set the specific height to prevent the content from jumping on page load.
      height: 32px;
    }

    .problem {
      font-size: 1rem;
      line-height: 1.5rem;
      color: #525252;
    }
  }

  .lambo-tape {
      max-width: 80%;
  }

  h2 {
      line-height: 2.5rem;
      font-size: 2.5rem;
  }

  section#cards {
    h2 {
        line-height: 1rem;
        font-size: unset;
        margin: 0;
        font-style: italic;
    }
  }
</style>

<script define:vars={{ problems }}>
  document.addEventListener("DOMContentLoaded", () => {
    const buttons = document.querySelectorAll("[data-refresh-button]");
    const problemTitle = document.querySelector("[data-problem]");
    if (!problemTitle || !buttons) {
      console.error("Problem title or buttons not found");
      return;
    }

    function newRandomProblem() {
      const randomProblemKey = Math.floor(Math.random() * problems.length);
      const problem = problems[randomProblemKey];

      problemTitle.classList.add("visible");
      problemTitle.textContent = problem;
    }

    buttons.forEach((button) => {
      button.addEventListener("click", () => {
        newRandomProblem();
      });
    });

    newRandomProblem();
  });
</script>
